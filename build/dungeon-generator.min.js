/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

//     Underscore.js 1.4.4
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore may be freely distributed under the MIT license.

/* 
  ===========================================================================

  dungCarv

  ===========================================================================

  Copyright 2009 Łukasz Jasiński
 
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
 
  http://www.apache.org/licenses/LICENSE-2.0
 
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  ===========================================================================

  For minified version check dungCarv.min.js file.

  ===========================================================================
*/

(function(t,n){"function"==typeof define&&define.amd?define(n):t.VAPI.CannonApp=n()})(this,function(){var t,n,e;return function(r){function i(t,n){return T.call(t,n)}function a(t,n){var e,r,i,a,u,o,s,c,l,f,h=n&&n.split("/"),p=g.map,d=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(n){for(h=h.slice(0,h.length-1),t=h.concat(t.split("/")),c=0;t.length>c;c+=1)if(f=t[c],"."===f)t.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||d)&&p){for(e=t.split("/"),c=e.length;c>0;c-=1){if(r=e.slice(0,c).join("/"),h)for(l=h.length;l>0;l-=1)if(i=p[h.slice(0,l).join("/")],i&&(i=i[r])){a=i,u=c;break}if(a)break;!o&&d&&d[r]&&(o=d[r],s=c)}!a&&o&&(a=o,u=s),a&&(e.splice(0,u,a),t=e.join("/"))}return t}function u(t,n){return function(){return p.apply(r,E.call(arguments,0).concat([t,n]))}}function o(t){return function(n){return a(n,t)}}function s(t){return function(n){v[t]=n}}function c(t){if(i(y,t)){var n=y[t];delete y[t],x[t]=!0,h.apply(r,n)}if(!i(v,t)&&!i(x,t))throw Error("No "+t);return v[t]}function l(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function f(t){return function(){return g&&g.config&&g.config[t]||{}}}var h,p,d,m,v={},y={},g={},x={},T=Object.prototype.hasOwnProperty,E=[].slice;d=function(t,n){var e,r=l(t),i=r[0];return t=r[1],i&&(i=a(i,n),e=c(i)),i?t=e&&e.normalize?e.normalize(t,o(n)):a(t,n):(t=a(t,n),r=l(t),i=r[0],t=r[1],i&&(e=c(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:e}},m={require:function(t){return u(t)},exports:function(t){var n=v[t];return n!==void 0?n:v[t]={}},module:function(t){return{id:t,uri:"",exports:v[t],config:f(t)}}},h=function(t,n,e,a){var o,l,f,h,p,g,T=[];if(a=a||t,"function"==typeof e){for(n=!n.length&&e.length?["require","exports","module"]:n,p=0;n.length>p;p+=1)if(h=d(n[p],a),l=h.f,"require"===l)T[p]=m.require(t);else if("exports"===l)T[p]=m.exports(t),g=!0;else if("module"===l)o=T[p]=m.module(t);else if(i(v,l)||i(y,l)||i(x,l))T[p]=c(l);else{if(!h.p)throw Error(t+" missing "+l);h.p.load(h.n,u(a,!0),s(l),{}),T[p]=v[l]}f=e.apply(v[t],T),t&&(o&&o.exports!==r&&o.exports!==v[t]?v[t]=o.exports:f===r&&g||(v[t]=f))}else t&&(v[t]=e)},t=n=p=function(t,n,e,i,a){return"string"==typeof t?m[t]?m[t](n):c(d(t,n).f):(t.splice||(g=t,n.splice?(t=n,n=e,e=null):t=r),n=n||function(){},"function"==typeof e&&(e=i,i=a),i?h(r,t,n,e):setTimeout(function(){h(r,t,n,e)},4),p)},p.config=function(t){return g=t,g.deps&&p(g.deps,g.callback),p},e=function(t,n,e){n.splice||(e=n,n=[]),i(v,t)||i(y,t)||(y[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("vendor/almond",function(){}),function(){var t=this,n=t._,r={},i=Array.prototype,a=Object.prototype,u=Function.prototype,o=i.push,s=i.slice,c=i.concat,l=a.toString,f=a.hasOwnProperty,h=i.forEach,p=i.map,d=i.reduce,m=i.reduceRight,v=i.filter,y=i.every,g=i.some,x=i.indexOf,T=i.lastIndexOf,E=Array.isArray,_=Object.keys,O=u.bind,R=function(t){return t instanceof R?t:this instanceof R?(this._wrapped=t,void 0):new R(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=R),exports._=R):t._=R,R.VERSION="1.4.4";var I=R.each=R.forEach=function(t,n,e){if(null!=t)if(h&&t.forEach===h)t.forEach(n,e);else if(t.length===+t.length){for(var i=0,a=t.length;a>i;i++)if(n.call(e,t[i],i,t)===r)return}else for(var u in t)if(R.has(t,u)&&n.call(e,t[u],u,t)===r)return};R.map=R.collect=function(t,n,e){var r=[];return null==t?r:p&&t.map===p?t.map(n,e):(I(t,function(t,i,a){r[r.length]=n.call(e,t,i,a)}),r)};var b="Reduce of empty array with no initial value";R.reduce=R.foldl=R.inject=function(t,n,e,r){var i=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return r&&(n=R.bind(n,r)),i?t.reduce(n,e):t.reduce(n);if(I(t,function(t,a,u){i?e=n.call(r,e,t,a,u):(e=t,i=!0)}),!i)throw new TypeError(b);return e},R.reduceRight=R.foldr=function(t,n,e,r){var i=arguments.length>2;if(null==t&&(t=[]),m&&t.reduceRight===m)return r&&(n=R.bind(n,r)),i?t.reduceRight(n,e):t.reduceRight(n);var a=t.length;if(a!==+a){var u=R.keys(t);a=u.length}if(I(t,function(o,s,c){s=u?u[--a]:--a,i?e=n.call(r,e,t[s],s,c):(e=t[s],i=!0)}),!i)throw new TypeError(b);return e},R.find=R.detect=function(t,n,e){var r;return N(t,function(t,i,a){return n.call(e,t,i,a)?(r=t,!0):void 0}),r},R.filter=R.select=function(t,n,e){var r=[];return null==t?r:v&&t.filter===v?t.filter(n,e):(I(t,function(t,i,a){n.call(e,t,i,a)&&(r[r.length]=t)}),r)},R.reject=function(t,n,e){return R.filter(t,function(t,r,i){return!n.call(e,t,r,i)},e)},R.every=R.all=function(t,n,e){n||(n=R.identity);var i=!0;return null==t?i:y&&t.every===y?t.every(n,e):(I(t,function(t,a,u){return(i=i&&n.call(e,t,a,u))?void 0:r}),!!i)};var N=R.some=R.any=function(t,n,e){n||(n=R.identity);var i=!1;return null==t?i:g&&t.some===g?t.some(n,e):(I(t,function(t,a,u){return i||(i=n.call(e,t,a,u))?r:void 0}),!!i)};R.contains=R.include=function(t,n){return null==t?!1:x&&t.indexOf===x?-1!=t.indexOf(n):N(t,function(t){return t===n})},R.invoke=function(t,n){var e=s.call(arguments,2),r=R.isFunction(n);return R.map(t,function(t){return(r?n:t[n]).apply(t,e)})},R.pluck=function(t,n){return R.map(t,function(t){return t[n]})},R.where=function(t,n,e){return R.isEmpty(n)?e?null:[]:R[e?"find":"filter"](t,function(t){for(var e in n)if(n[e]!==t[e])return!1;return!0})},R.findWhere=function(t,n){return R.where(t,n,!0)},R.max=function(t,n,e){if(!n&&R.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.max.apply(Math,t);if(!n&&R.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return I(t,function(t,i,a){var u=n?n.call(e,t,i,a):t;u>=r.computed&&(r={value:t,computed:u})}),r.value},R.min=function(t,n,e){if(!n&&R.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.min.apply(Math,t);if(!n&&R.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return I(t,function(t,i,a){var u=n?n.call(e,t,i,a):t;r.computed>u&&(r={value:t,computed:u})}),r.value},R.shuffle=function(t){var n,e=0,r=[];return I(t,function(t){n=R.random(e++),r[e-1]=r[n],r[n]=t}),r};var D=function(t){return R.isFunction(t)?t:function(n){return n[t]}};R.sortBy=function(t,n,e){var r=D(n);return R.pluck(R.map(t,function(t,n,i){return{value:t,index:n,criteria:r.call(e,t,n,i)}}).sort(function(t,n){var e=t.criteria,r=n.criteria;if(e!==r){if(e>r||void 0===e)return 1;if(r>e||void 0===r)return-1}return t.index<n.index?-1:1}),"value")};var L=function(t,n,e,r){var i={},a=D(n||R.identity);return I(t,function(n,u){var o=a.call(e,n,u,t);r(i,o,n)}),i};R.groupBy=function(t,n,e){return L(t,n,e,function(t,n,e){(R.has(t,n)?t[n]:t[n]=[]).push(e)})},R.countBy=function(t,n,e){return L(t,n,e,function(t,n){R.has(t,n)||(t[n]=0),t[n]++})},R.sortedIndex=function(t,n,e,r){e=null==e?R.identity:D(e);for(var i=e.call(r,n),a=0,u=t.length;u>a;){var o=a+u>>>1;i>e.call(r,t[o])?a=o+1:u=o}return a},R.toArray=function(t){return t?R.isArray(t)?s.call(t):t.length===+t.length?R.map(t,R.identity):R.values(t):[]},R.size=function(t){return null==t?0:t.length===+t.length?t.length:R.keys(t).length},R.first=R.head=R.take=function(t,n,e){return null==t?void 0:null==n||e?t[0]:s.call(t,0,n)},R.initial=function(t,n,e){return s.call(t,0,t.length-(null==n||e?1:n))},R.last=function(t,n,e){return null==t?void 0:null==n||e?t[t.length-1]:s.call(t,Math.max(t.length-n,0))},R.rest=R.tail=R.drop=function(t,n,e){return s.call(t,null==n||e?1:n)},R.compact=function(t){return R.filter(t,R.identity)};var A=function(t,n,e){return I(t,function(t){R.isArray(t)?n?o.apply(e,t):A(t,n,e):e.push(t)}),e};R.flatten=function(t,n){return A(t,n,[])},R.without=function(t){return R.difference(t,s.call(arguments,1))},R.uniq=R.unique=function(t,n,e,r){R.isFunction(n)&&(r=e,e=n,n=!1);var i=e?R.map(t,e,r):t,a=[],u=[];return I(i,function(e,r){(n?r&&u[u.length-1]===e:R.contains(u,e))||(u.push(e),a.push(t[r]))}),a},R.union=function(){return R.uniq(c.apply(i,arguments))},R.intersection=function(t){var n=s.call(arguments,1);return R.filter(R.uniq(t),function(t){return R.every(n,function(n){return R.indexOf(n,t)>=0})})},R.difference=function(t){var n=c.apply(i,s.call(arguments,1));return R.filter(t,function(t){return!R.contains(n,t)})},R.zip=function(){for(var t=s.call(arguments),n=R.max(R.pluck(t,"length")),e=Array(n),r=0;n>r;r++)e[r]=R.pluck(t,""+r);return e},R.object=function(t,n){if(null==t)return{};for(var e={},r=0,i=t.length;i>r;r++)n?e[t[r]]=n[r]:e[t[r][0]]=t[r][1];return e},R.indexOf=function(t,n,e){if(null==t)return-1;var r=0,i=t.length;if(e){if("number"!=typeof e)return r=R.sortedIndex(t,n),t[r]===n?r:-1;r=0>e?Math.max(0,i+e):e}if(x&&t.indexOf===x)return t.indexOf(n,e);for(;i>r;r++)if(t[r]===n)return r;return-1},R.lastIndexOf=function(t,n,e){if(null==t)return-1;var r=null!=e;if(T&&t.lastIndexOf===T)return r?t.lastIndexOf(n,e):t.lastIndexOf(n);for(var i=r?e:t.length;i--;)if(t[i]===n)return i;return-1},R.range=function(t,n,e){1>=arguments.length&&(n=t||0,t=0),e=arguments[2]||1;for(var r=Math.max(Math.ceil((n-t)/e),0),i=0,a=Array(r);r>i;)a[i++]=t,t+=e;return a},R.bind=function(t,n){if(t.bind===O&&O)return O.apply(t,s.call(arguments,1));var e=s.call(arguments,2);return function(){return t.apply(n,e.concat(s.call(arguments)))}},R.partial=function(t){var n=s.call(arguments,1);return function(){return t.apply(this,n.concat(s.call(arguments)))}},R.bindAll=function(t){var n=s.call(arguments,1);return 0===n.length&&(n=R.functions(t)),I(n,function(n){t[n]=R.bind(t[n],t)}),t},R.memoize=function(t,n){var e={};return n||(n=R.identity),function(){var r=n.apply(this,arguments);return R.has(e,r)?e[r]:e[r]=t.apply(this,arguments)}},R.delay=function(t,n){var e=s.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},n)},R.defer=function(t){return R.delay.apply(R,[t,1].concat(s.call(arguments,1)))},R.throttle=function(t,n){var e,r,i,a,u=0,o=function(){u=new Date,i=null,a=t.apply(e,r)};return function(){var s=new Date,c=n-(s-u);return e=this,r=arguments,0>=c?(clearTimeout(i),i=null,u=s,a=t.apply(e,r)):i||(i=setTimeout(o,c)),a}},R.debounce=function(t,n,e){var r,i;return function(){var a=this,u=arguments,o=function(){r=null,e||(i=t.apply(a,u))},s=e&&!r;return clearTimeout(r),r=setTimeout(o,n),s&&(i=t.apply(a,u)),i}},R.once=function(t){var n,e=!1;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}},R.wrap=function(t,n){return function(){var e=[t];return o.apply(e,arguments),n.apply(this,e)}},R.compose=function(){var t=arguments;return function(){for(var n=arguments,e=t.length-1;e>=0;e--)n=[t[e].apply(this,n)];return n[0]}},R.after=function(t,n){return 0>=t?n():function(){return 1>--t?n.apply(this,arguments):void 0}},R.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var n=[];for(var e in t)R.has(t,e)&&(n[n.length]=e);return n},R.values=function(t){var n=[];for(var e in t)R.has(t,e)&&n.push(t[e]);return n},R.pairs=function(t){var n=[];for(var e in t)R.has(t,e)&&n.push([e,t[e]]);return n},R.invert=function(t){var n={};for(var e in t)R.has(t,e)&&(n[t[e]]=e);return n},R.functions=R.methods=function(t){var n=[];for(var e in t)R.isFunction(t[e])&&n.push(e);return n.sort()},R.extend=function(t){return I(s.call(arguments,1),function(n){if(n)for(var e in n)t[e]=n[e]}),t},R.pick=function(t){var n={},e=c.apply(i,s.call(arguments,1));return I(e,function(e){e in t&&(n[e]=t[e])}),n},R.omit=function(t){var n={},e=c.apply(i,s.call(arguments,1));for(var r in t)R.contains(e,r)||(n[r]=t[r]);return n},R.defaults=function(t){return I(s.call(arguments,1),function(n){if(n)for(var e in n)null==t[e]&&(t[e]=n[e])}),t},R.clone=function(t){return R.isObject(t)?R.isArray(t)?t.slice():R.extend({},t):t},R.tap=function(t,n){return n(t),t};var w=function(t,n,e,r){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return t===n;t instanceof R&&(t=t._wrapped),n instanceof R&&(n=n._wrapped);var i=l.call(t);if(i!=l.call(n))return!1;switch(i){case"[object String]":return t==n+"";case"[object Number]":return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if("object"!=typeof t||"object"!=typeof n)return!1;for(var a=e.length;a--;)if(e[a]==t)return r[a]==n;e.push(t),r.push(n);var u=0,o=!0;if("[object Array]"==i){if(u=t.length,o=u==n.length)for(;u--&&(o=w(t[u],n[u],e,r)););}else{var s=t.constructor,c=n.constructor;if(s!==c&&!(R.isFunction(s)&&s instanceof s&&R.isFunction(c)&&c instanceof c))return!1;for(var f in t)if(R.has(t,f)&&(u++,!(o=R.has(n,f)&&w(t[f],n[f],e,r))))break;if(o){for(f in n)if(R.has(n,f)&&!u--)break;o=!u}}return e.pop(),r.pop(),o};R.isEqual=function(t,n){return w(t,n,[],[])},R.isEmpty=function(t){if(null==t)return!0;if(R.isArray(t)||R.isString(t))return 0===t.length;for(var n in t)if(R.has(t,n))return!1;return!0},R.isElement=function(t){return!(!t||1!==t.nodeType)},R.isArray=E||function(t){return"[object Array]"==l.call(t)},R.isObject=function(t){return t===Object(t)},I(["Arguments","Function","String","Number","Date","RegExp"],function(t){R["is"+t]=function(n){return l.call(n)=="[object "+t+"]"}}),R.isArguments(arguments)||(R.isArguments=function(t){return!(!t||!R.has(t,"callee"))}),R.isFunction=function(t){return"function"==typeof t},R.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},R.isNaN=function(t){return R.isNumber(t)&&t!=+t},R.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},R.isNull=function(t){return null===t},R.isUndefined=function(t){return void 0===t},R.has=function(t,n){return f.call(t,n)},R.noConflict=function(){return t._=n,this},R.identity=function(t){return t},R.times=function(t,n,e){for(var r=Array(t),i=0;t>i;i++)r[i]=n.call(e,i);return r},R.random=function(t,n){return null==n&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))};var S={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};S.unescape=R.invert(S.escape);var k={escape:RegExp("["+R.keys(S.escape).join("")+"]","g"),unescape:RegExp("("+R.keys(S.unescape).join("|")+")","g")};R.each(["escape","unescape"],function(t){R[t]=function(n){return null==n?"":(""+n).replace(k[t],function(n){return S[t][n]})}}),R.result=function(t,n){if(null==t)return null;var e=t[n];return R.isFunction(e)?e.call(t):e},R.mixin=function(t){I(R.functions(t),function(n){var e=R[n]=t[n];R.prototype[n]=function(){var t=[this._wrapped];return o.apply(t,arguments),B.call(this,e.apply(R,t))}})};var W=0;R.uniqueId=function(t){var n=++W+"";return t?t+n:n},R.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;R.template=function(t,n,e){var r;e=R.defaults({},e,R.templateSettings);var i=RegExp([(e.escape||C).source,(e.interpolate||C).source,(e.evaluate||C).source].join("|")+"|$","g"),a=0,u="__p+='";t.replace(i,function(n,e,r,i,o){return u+=t.slice(a,o).replace(j,function(t){return"\\"+M[t]}),e&&(u+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(u+="';\n"+i+"\n__p+='"),a=o+n.length,n}),u+="';\n",e.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{r=Function(e.variable||"obj","_",u)}catch(o){throw o.source=u,o}if(n)return r(n,R);var s=function(t){return r.call(this,t,R)};return s.source="function("+(e.variable||"obj")+"){\n"+u+"}",s},R.chain=function(t){return R(t).chain()};var B=function(t){return this._chain?R(t).chain():t};R.mixin(R),I(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=i[t];R.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],B.call(this,e)}}),I(["concat","join","slice"],function(t){var n=i[t];R.prototype[t]=function(){return B.call(this,n.apply(this._wrapped,arguments))}}),R.extend(R.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof e&&e.amd&&e("underscore",[],function(){return R})}.call(this),function(){function t(t){var e=!1;return function(){if(e)throw Error("Callback was already called.");e=!0,t.apply(n,arguments)}}var n,r,i={};n=this,null!=n&&(r=n.async),i.noConflict=function(){return n.async=r,i};var a=function(t,n){if(t.forEach)return t.forEach(n);for(var e=0;t.length>e;e+=1)n(t[e],e,t)},u=function(t,n){if(t.map)return t.map(n);var e=[];return a(t,function(t,r,i){e.push(n(t,r,i))}),e},o=function(t,n,e){return t.reduce?t.reduce(n,e):(a(t,function(t,r,i){e=n(e,t,r,i)}),e)},s=function(t){if(Object.keys)return Object.keys(t);var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e);return n};"undefined"!=typeof process&&process.nextTick?(i.nextTick=process.nextTick,i.setImmediate="undefined"!=typeof setImmediate?setImmediate:i.nextTick):"function"==typeof setImmediate?(i.setImmediate=setImmediate,i.nextTick=setImmediate):(i.nextTick=function(t){setTimeout(t,0)},i.setImmediate=i.nextTick),i.each=function(n,e,r){if(r=r||function(){},!n.length)return r();var i=0;a(n,function(a){e(a,t(function(t){t?(r(t),r=function(){}):(i+=1,i>=n.length&&r(null))}))})},i.forEach=i.each,i.eachSeries=function(t,n,e){if(e=e||function(){},!t.length)return e();var r=0,i=function(){n(t[r],function(n){n?(e(n),e=function(){}):(r+=1,r>=t.length?e(null):i())})};i()},i.forEachSeries=i.eachSeries,i.eachLimit=function(t,n,e,r){var i=c(n);i.apply(null,[t,e,r])},i.forEachLimit=i.eachLimit;var c=function(t){return function(n,e,r){if(r=r||function(){},!n.length||0>=t)return r();var i=0,a=0,u=0;(function o(){if(i>=n.length)return r();for(;t>u&&n.length>a;)a+=1,u+=1,e(n[a-1],function(t){t?(r(t),r=function(){}):(i+=1,u-=1,i>=n.length?r():o())})})()}},l=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[i.each].concat(n))}},f=function(t,n){return function(){var e=Array.prototype.slice.call(arguments);return n.apply(null,[c(t)].concat(e))}},h=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[i.eachSeries].concat(n))}},p=function(t,n,e,r){var i=[];n=u(n,function(t,n){return{index:n,value:t}}),t(n,function(t,n){e(t.value,function(e,r){i[t.index]=r,n(e)})},function(t){r(t,i)})};i.map=l(p),i.mapSeries=h(p),i.mapLimit=function(t,n,e,r){return d(n)(t,e,r)};var d=function(t){return f(t,p)};i.reduce=function(t,n,e,r){i.eachSeries(t,function(t,r){e(n,t,function(t,e){n=e,r(t)})},function(t){r(t,n)})},i.inject=i.reduce,i.foldl=i.reduce,i.reduceRight=function(t,n,e,r){var a=u(t,function(t){return t}).reverse();i.reduce(a,n,e,r)},i.foldr=i.reduceRight;var m=function(t,n,e,r){var i=[];n=u(n,function(t,n){return{index:n,value:t}}),t(n,function(t,n){e(t.value,function(e){e&&i.push(t),n()})},function(){r(u(i.sort(function(t,n){return t.index-n.index}),function(t){return t.value}))})};i.filter=l(m),i.filterSeries=h(m),i.select=i.filter,i.selectSeries=i.filterSeries;var v=function(t,n,e,r){var i=[];n=u(n,function(t,n){return{index:n,value:t}}),t(n,function(t,n){e(t.value,function(e){e||i.push(t),n()})},function(){r(u(i.sort(function(t,n){return t.index-n.index}),function(t){return t.value}))})};i.reject=l(v),i.rejectSeries=h(v);var y=function(t,n,e,r){t(n,function(t,n){e(t,function(e){e?(r(t),r=function(){}):n()})},function(){r()})};i.detect=l(y),i.detectSeries=h(y),i.some=function(t,n,e){i.each(t,function(t,r){n(t,function(t){t&&(e(!0),e=function(){}),r()})},function(){e(!1)})},i.any=i.some,i.every=function(t,n,e){i.each(t,function(t,r){n(t,function(t){t||(e(!1),e=function(){}),r()})},function(){e(!0)})},i.all=i.every,i.sortBy=function(t,n,e){i.map(t,function(t,e){n(t,function(n,r){n?e(n):e(null,{value:t,criteria:r})})},function(t,n){if(t)return e(t);var r=function(t,n){var e=t.criteria,r=n.criteria;return r>e?-1:e>r?1:0};e(null,u(n.sort(r),function(t){return t.value}))})},i.auto=function(t,n){n=n||function(){};var e=s(t);if(!e.length)return n(null);var r={},u=[],c=function(t){u.unshift(t)},l=function(t){for(var n=0;u.length>n;n+=1)if(u[n]===t)return u.splice(n,1),void 0},f=function(){a(u.slice(0),function(t){t()})};c(function(){s(r).length===e.length&&(n(null,r),n=function(){})}),a(e,function(e){var u=t[e]instanceof Function?[t[e]]:t[e],h=function(t){var u=Array.prototype.slice.call(arguments,1);if(1>=u.length&&(u=u[0]),t){var o={};a(s(r),function(t){o[t]=r[t]}),o[e]=u,n(t,o),n=function(){}}else r[e]=u,i.setImmediate(f)},p=u.slice(0,Math.abs(u.length-1))||[],d=function(){return o(p,function(t,n){return t&&r.hasOwnProperty(n)},!0)&&!r.hasOwnProperty(e)};if(d())u[u.length-1](h,r);else{var m=function(){d()&&(l(m),u[u.length-1](h,r))};c(m)}})},i.waterfall=function(t,n){if(n=n||function(){},t.constructor!==Array){var e=Error("First argument to waterfall must be an array of functions");return n(e)}if(!t.length)return n();var r=function(t){return function(e){if(e)n.apply(null,arguments),n=function(){};else{var a=Array.prototype.slice.call(arguments,1),u=t.next();u?a.push(r(u)):a.push(n),i.setImmediate(function(){t.apply(null,a)})}}};r(i.iterator(t))()};var g=function(t,n,e){if(e=e||function(){},n.constructor===Array)t.map(n,function(t,n){t&&t(function(t){var e=Array.prototype.slice.call(arguments,1);1>=e.length&&(e=e[0]),n.call(null,t,e)})},e);else{var r={};t.each(s(n),function(t,e){n[t](function(n){var i=Array.prototype.slice.call(arguments,1);1>=i.length&&(i=i[0]),r[t]=i,e(n)})},function(t){e(t,r)})}};i.parallel=function(t,n){g({map:i.map,each:i.each},t,n)},i.parallelLimit=function(t,n,e){g({map:d(n),each:c(n)},t,e)},i.series=function(t,n){if(n=n||function(){},t.constructor===Array)i.mapSeries(t,function(t,n){t&&t(function(t){var e=Array.prototype.slice.call(arguments,1);1>=e.length&&(e=e[0]),n.call(null,t,e)})},n);else{var e={};i.eachSeries(s(t),function(n,r){t[n](function(t){var i=Array.prototype.slice.call(arguments,1);1>=i.length&&(i=i[0]),e[n]=i,r(t)})},function(t){n(t,e)})}},i.iterator=function(t){var n=function(e){var r=function(){return t.length&&t[e].apply(null,arguments),r.next()};return r.next=function(){return t.length-1>e?n(e+1):null},r};return n(0)},i.apply=function(t){var n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,n.concat(Array.prototype.slice.call(arguments)))}};var x=function(t,n,e,r){var i=[];t(n,function(t,n){e(t,function(t,e){i=i.concat(e||[]),n(t)})},function(t){r(t,i)})};i.concat=l(x),i.concatSeries=h(x),i.whilst=function(t,n,e){t()?n(function(r){return r?e(r):(i.whilst(t,n,e),void 0)}):e()},i.doWhilst=function(t,n,e){t(function(r){return r?e(r):(n()?i.doWhilst(t,n,e):e(),void 0)})},i.until=function(t,n,e){t()?e():n(function(r){return r?e(r):(i.until(t,n,e),void 0)})},i.doUntil=function(t,n,e){t(function(r){return r?e(r):(n()?e():i.doUntil(t,n,e),void 0)})},i.queue=function(n,e){function r(t,n,r,u){n.constructor!==Array&&(n=[n]),a(n,function(n){var a={data:n,callback:"function"==typeof u?u:null};r?t.tasks.unshift(a):t.tasks.push(a),t.saturated&&t.tasks.length===e&&t.saturated(),i.setImmediate(t.process)})}void 0===e&&(e=1);var u=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,push:function(t,n){r(o,t,!1,n)},unshift:function(t,n){r(o,t,!0,n)},process:function(){if(o.concurrency>u&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),u+=1;var r=function(){u-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&0===o.tasks.length+u&&o.drain(),o.process()},i=t(r);n(e.data,i)}},length:function(){return o.tasks.length},running:function(){return u}};return o},i.cargo=function(t,n){var e=!1,r=[],o={tasks:r,payload:n,saturated:null,empty:null,drain:null,push:function(t,e){t.constructor!==Array&&(t=[t]),a(t,function(t){r.push({data:t,callback:"function"==typeof e?e:null}),o.saturated&&r.length===n&&o.saturated()}),i.setImmediate(o.process)},process:function s(){if(!e){if(0===r.length)return o.drain&&o.drain(),void 0;var i="number"==typeof n?r.splice(0,n):r.splice(0),c=u(i,function(t){return t.data});o.empty&&o.empty(),e=!0,t(c,function(){e=!1;var t=arguments;a(i,function(n){n.callback&&n.callback.apply(null,t)}),s()})}},length:function(){return r.length},running:function(){return e}};return o};var T=function(t){return function(n){var e=Array.prototype.slice.call(arguments,1);n.apply(null,e.concat([function(n){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(n?console.error&&console.error(n):console[t]&&a(e,function(n){console[t](n)}))}]))}};i.log=T("log"),i.dir=T("dir"),i.memoize=function(t,n){var e={},r={};n=n||function(t){return t};var i=function(){var i=Array.prototype.slice.call(arguments),a=i.pop(),u=n.apply(null,i);u in e?a.apply(null,e[u]):u in r?r[u].push(a):(r[u]=[a],t.apply(null,i.concat([function(){e[u]=arguments;var t=r[u];delete r[u];for(var n=0,i=t.length;i>n;n++)t[n].apply(null,arguments)}])))};return i.memo=e,i.unmemoized=t,i},i.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},i.times=function(t,n,e){for(var r=[],a=0;t>a;a++)r.push(a);return i.map(r,n,e)},i.timesSeries=function(t,n,e){for(var r=[],a=0;t>a;a++)r.push(a);return i.mapSeries(r,n,e)},i.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var n=this,e=Array.prototype.slice.call(arguments),r=e.pop();i.reduce(t,e,function(t,e,r){e.apply(n,t.concat([function(){var t=arguments[0],n=Array.prototype.slice.call(arguments,1);r(t,n)}]))},function(t,e){r.apply(n,[t].concat(e))})}};var E=function(t,n){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),i=r.pop();return t(n,function(t,n){t.apply(e,r.concat([n]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};i.applyEach=l(E),i.applyEachSeries=h(E),i.forever=function(t,n){function e(r){if(r){if(n)return n(r);throw r}t(e)}e()},e!==void 0&&e.amd?e("async",[],function(){return i}):"undefined"!=typeof module&&module.exports?module.exports=i:n.async=i}(),e("dungcarv",[],function(){function t(t){return t.padding||(t.padding=1),t.randomness||(t.randomness=0),t.twistness||(t.twistness=0),t.loops||(t.loops=0),t.spaces||(t.spaces=0),t.loopSpaceRepeat||(t.loopSpaceRepeat=1),t.roomSize||(t.roomSize=[]),t.rooms&&0!=t.roomSize.length||(t.rooms=0),t.mapWidth&&t.mapHeight?{MAP_WIDTH:t.mapWidth,MAP_HEIGHT:t.mapHeight,TILE_WALL:0,TILE_CORRIDOR:1,TILE_ROOM:2,TILE_DOOR:3,TILE_ENTRANCE:4,TILE_EXIT:5,TILE_ROOM_TMP:9998,TILE_WALL_TMP:9999,BOUND_TOP:t.padding,BOUND_RIGHT:t.mapWidth-t.padding-1,BOUND_BOTTOM:t.mapHeight-t.padding-1,BOUND_LEFT:t.padding,DIR_NONE:0,DIR_UP:1,DIR_RIGHT:2,DIR_DOWN:3,DIR_LEFT:4,map:[],queue:[],success:!1,started:!1,finished:!1,dir:this.DIR_NONE,elem:null,create:function(){this.fill(this.TILE_WALL),this.generate(),t.loopSpaceRepeat>0&&t.spacesBeforeLoops&&t.spaces>0&&this.makeSpaces();for(var n=0;t.loopSpaceRepeat>n;n++)t.loops>0&&this.makeLoops(),t.spaces>0&&this.makeSpaces();return t.eraseRoomDeadEnds&&this.eraseRoomDeadEnds(),this.returnValue()},generate:function(){for(;!this.finished;)this.step()},step:function(){if(!this.started){var n,e;return t.entrance&&t.entrance.x&&t.entrance.y?(n=t.entrance.x,e=t.entrance.y):(n=Math.rnd(this.BOUND_LEFT,this.BOUND_RIGHT),e=Math.rnd(this.BOUND_TOP,this.BOUND_BOTTOM)),this.started=!0,this.queue.push({x:n,y:e}),this.set(n,e,this.TILE_ENTRANCE),void 0}if(this.elem&&this.queue.length>0&&Math.random()<t.randomness){var n=this.elem.x,e=this.elem.y;this.elem=this.queue.rnd(),this.queue.push({x:n,y:e})}if(!this.elem){if(0==this.queue.length)return this.finished=!0,void 0;this.elem=this.queue.rnd()}var r=this.avaibleDir(this.elem.x,this.elem.y);if(0==r.length)return this.elem=null,void 0;switch((-1==r.indexOf(this.dir)||Math.random()<t.twistness)&&(this.dir=r.rnd()),this.dir){case this.DIR_UP:this.elem.y--;break;case this.DIR_RIGHT:this.elem.x++;break;case this.DIR_DOWN:this.elem.y++;break;case this.DIR_LEFT:this.elem.x--}return Math.random()<t.rooms&&this.placeRoom(this.elem.x,this.elem.y,this.dir)?(this.queue.push({x:this.elem.x,y:this.elem.y}),this.elem=null,void 0):(this.set(this.elem.x,this.elem.y,this.TILE_CORRIDOR),this.queue.push({x:this.elem.x,y:this.elem.y}),void 0)},placeRoom:function(n,e,r){for(var i,a=Math.random(),u=0,o=-1,s=0;t.roomSize.length>s;s++)if(i=t.roomSize[s],u+=i.prob,u>a){o=s;break}if(-1==o)return!1;i=t.roomSize[o];var c=Math.rnd(i.min,i.max),l=Math.rnd(i.min,i.max),f=[],h={};switch(r){case this.DIR_UP:h={t:e-l,r:n,b:e-l,l:n-c+1};break;case this.DIR_RIGHT:h={t:e-l+1,r:n+1,b:e,l:n+1};break;case this.DIR_DOWN:h={t:e+1,r:n,b:e+1,l:n-c+1};break;case this.DIR_LEFT:h={t:e-l+1,r:n-c+1,b:e,l:n-c+1}}for(var p=h.l;h.r>=p;p++)for(var d=h.t;h.b>=d;d++){for(var m=!0,v=p-1;p+c>=v;v++)for(var y=d-1;d+l>=y;y++){if(!this.testTile(v,y,[this.TILE_WALL])){m=!1;break}if(!m)break}m&&f.push({x:p,y:d})}if(0==f.length)return!1;this.set(n,e,this.TILE_CORRIDOR);for(var g=f.rnd(),v=g.x;g.x+c>v;v++)for(var y=g.y;g.y+l>y;y++)this.set(v,y,this.TILE_ROOM_TMP);for(var v=g.x;g.x+c>v;v++)for(var y=g.y;g.y+l>y;y++)t.roomRound&&this.roundCorner(v,y,g.x,g.y,c,l)?this.set(v,y,this.TILE_WALL):((v==g.x||v==g.x+c-1||y==g.y||y==g.y+l-1)&&this.queue.push({x:v,y:y}),this.set(v,y,this.TILE_ROOM));return!0},roundCorner:function(){return!1},makeLoops:function(){for(var n=[],e=[],r=this.BOUND_LEFT;this.BOUND_RIGHT>=r;r++)for(var i=this.BOUND_TOP;this.BOUND_BOTTOM>=i;i++)e[this.xy(r,i)]=!0;for(var r=this.BOUND_LEFT;this.BOUND_RIGHT>=r;r++)for(var i=this.BOUND_TOP;this.BOUND_BOTTOM>=i;i++){var a=this.xy(r,i);if(this.testTile(r,i,[this.TILE_WALL]))e[a]=!1;else{var u=this.adjacent(r,i);if(1==u.length&&Math.random()<t.loops){var o=u.pop();e[a]=!1,e[this.xy(o.x,o.y)]=!1,n.push({x:r,y:i});var s=this.map[this.xy(o.x,o.y)];this.set(o.x,o.y,this.TILE_WALL);for(var c=this.diagonal(r,i),l=0;c.length>l;l++)e[this.xy(c[l].x,c[l].y)]=!1;this.set(o.x,o.y,s)}}}if(0!=n.length){for(var r=this.BOUND_LEFT;this.BOUND_RIGHT>=r;r++)for(var i=this.BOUND_TOP;this.BOUND_BOTTOM>=i;i++)e[this.xy(r,i)]&&this.queue.push({x:r,y:i});for(var l=0;n.length>l;l++)this.set(n[l].x,n[l].y,this.TILE_WALL_TMP);this.finished=!1,this.generate();for(var l=0;n.length>l;l++)this.set(n[l].x,n[l].y,this.TILE_CORRIDOR)}},makeSpaces:function(){for(var n=0;t.spaces>n;n++){for(var e=[],r=this.BOUND_LEFT;this.BOUND_RIGHT>=r;r++)for(var i=this.BOUND_TOP;this.BOUND_BOTTOM>=i;i++)if(this.testTile(r,i,[this.TILE_CORRIDOR])){var a=this.adjacent(r,i);1==a.length&&e.push({x:r,y:i})}for(var u=0;e.length>u;u++)this.set(e[u].x,e[u].y,this.TILE_WALL)}},eraseRoomDeadEnds:function(){for(var t=this.BOUND_LEFT;this.BOUND_RIGHT>=t;t++)for(var n=this.BOUND_TOP;this.BOUND_BOTTOM>=n;n++)if(this.testTile(t,n,[this.TILE_CORRIDOR])){var e=this.adjacent(t,n);1==e.length&&(this.testTile(e[0].x,e[0].y,[this.TILE_ROOM]),this.set(t,n,this.TILE_WALL))}},set:function(t,n,e){this.map[this.xy(t,n)]=e},xy:function(n,e){return n+e*t.mapWidth},avaibleDir:function(t,n){var e=[];return this.canCarve(t,n-1)&&e.push(this.DIR_UP),this.canCarve(t+1,n)&&e.push(this.DIR_RIGHT),this.canCarve(t,n+1)&&e.push(this.DIR_DOWN),this.canCarve(t-1,n)&&e.push(this.DIR_LEFT),e},canCarve:function(t,n){if(!this.testTile(t,n,[this.TILE_WALL]))return!1;var e=this.adjacent(t,n),r=this.diagonal(t,n);return 1!=e.length?!1:0!=r.length?!1:!0},adjacent:function(t,n){var e=[],r=[this.TILE_ROOM,this.TILE_CORRIDOR,this.TILE_ENTRANCE];return this.testTile(t,n-1,r)&&e.push({x:t,y:n-1}),this.testTile(t+1,n,r)&&e.push({x:t+1,y:n}),this.testTile(t,n+1,r)&&e.push({x:t,y:n+1}),this.testTile(t-1,n,r)&&e.push({x:t-1,y:n}),e},diagonal:function(t,n){var e=[],r=[this.TILE_WALL,this.TILE_WALL_TMP];return!this.testTile(t-1,n-1,r)&&this.testTile(t-1,n,r)&&this.testTile(t,n-1,r)&&e.push({x:t-1,y:n-1}),!this.testTile(t+1,n-1,r)&&this.testTile(t+1,n,r)&&this.testTile(t,n-1,r)&&e.push({x:t+1,y:n-1}),!this.testTile(t+1,n+1,r)&&this.testTile(t+1,n,r)&&this.testTile(t,n+1,r)&&e.push({x:t+1,y:n+1}),!this.testTile(t-1,n+1,r)&&this.testTile(t-1,n,r)&&this.testTile(t,n+1,r)&&e.push({x:t-1,y:n+1}),e
},testTile:function(t,n,e){return this.BOUND_LEFT>t||t>this.BOUND_RIGHT?!1:this.BOUND_TOP>n||n>this.BOUND_BOTTOM?!1:-1!=e.indexOf(this.map[this.xy(t,n)])},returnValue:function(){this.success=!0;var n={success:this.success};return this.success&&(n.map=this.map,t.returnRoomData&&(n.roomData=this.generateRoomData()),t.returnDoorData&&(n.doorData=this.generateDoorData()),t.returnStatistics&&(n.statistics=this.generateStatistics())),n},fill:function(t){for(var n=this.xy,e=0;this.MAP_WIDTH>e;e++)for(var r=0;this.MAP_HEIGHT>r;r++)this.map[n(e,r)]=t}}.create():{success:!1}}return Array.prototype.rnd=function(){if(0==this.length)return null;var t=Math.floor(Math.random()*this.length);return this.splice(t,1).pop()},Math.rnd=function(t,n){return Math.floor(Math.random()*(n-t+1))+t},t}),e("map",["underscore","dungcarv"],function(t,n){function e(t){if(t=t||{},this.walkables=[],t.map)this.width=t.width,this.height=t.height,this.map=t.map;else{this.width=t.width||5,this.height=t.height||5;var e=n({mapWidth:this.width,mapHeight:this.height,padding:1,randomness:.1,twistness:.2,rooms:.25,roomSize:[{min:4,max:10,prob:1}],roomRound:!1,loops:0,spaces:0,loopSpaceRepeat:2,eraseRoomDeadEnds:!0,spacesBeforeLoops:!1});this.map=e.map}if(!this.width||!this.height)throw Error("You must provide both a width and height value");for(var r in this.map)this.map.hasOwnProperty(r)&&(this.map[r]===i.ENTRANCE?this.entrance=r:this.map[r]===i.EXIT&&(this.exit=r),this.map[r]!==i.WALL&&this.walkables.push(r))}var r={1:{x:-1,y:-1},2:{x:0,y:-1},4:{x:1,y:-1},8:{x:1,y:0},16:{x:1,y:1},32:{x:0,y:1},64:{x:-1,y:1},128:{x:-1,y:0}},i={WALL:0,CORRIDOR:1,ROOM:2,DOOR:3,ENTRANCE:4,EXIT:5};return e.prototype.getBits=function(n){var e=n%this.width,a=Math.floor(n/this.height),u=0;return t.each(r,function(t,n){var r=e+t.x,o=a+t.y,s=o*this.height+r;r>0&&this.width-1>r&&o>0&&this.height-1>o&&this.map[s]!==i.WALL&&(u|=parseInt(n,10))},this),u},e.prototype.getEntrance=function(){return this.get(this.entrance)},e.prototype.getExit=function(){return this.get(this.exit)},e.prototype.getRandomWalkable=function(){return this.get(this.walkables[Math.floor(Math.random()*this.walkables.length)])},e.prototype.each=function(t){for(var n=0;this.map.length>n;n++)t(this.get(n),parseInt(n,10))},e.prototype.get=function(t){var n=this.map[t],e=this._getPosition(t),r=this.getBits(t);return{idx:parseInt(t,10),position:e,tile:n,bits:r,walkable:n!==i.WALL}},e.prototype._getPosition=function(t){var n={x:t%this.width,y:Math.floor(t/this.width)};return n},e}),e("tile",["underscore"],function(t){function n(n){var e={NW:1,N:2,NE:4,E:8,SE:16,S:32,SW:64,W:128},r=[];return t.each(e,function(t,e){n&t&&r.push(e)}),r.join("|")}function e(t,n,e){if(0!==n)return t+"0";if(e===i)return t+"100";if(e===p)return t+"104";switch(e&p){case o|s|c:case o|s:case s|c:case s:return t+"101E";case c|l|f:case c|l:case l|f:case l:return t+"101S";case o|u|a:case o|u:case u|a:case u:return t+"101N";case a|h|f:case a|h:case h|f:case h:return t+"101W";case a|u|o|c|l|f:case a|u|o|c|l|f:case a|u|o|c|l:case a|u|o|l|f:case a|u|c|l|f:case u|o|c|l|f:case u|o|c|l:case u|o|f|l:case u|a|c|l:case u|a|f|l:case u|a|o|l:case u|c|l|f:case u|o|l:case u|a|l:case u|f|l:case u|c|l:case u|l:return t+"102NS";case a|o|s|c|f|h:case o|s|c|f|h:case a|o|s|c|h:case a|s|c|f|h:case a|o|s|f|h:case a|o|s|h:case o|s|c|h:case a|s|f|h:case o|s|f|h:case a|s|c|h:case s|c|f|h:case s|f|h:case s|c|h:case o|s|h:case a|s|h:case s|h:return t+"102WE";case o|s|c|l|f:case s|c|l|f:case o|s|c|l:case a|s|c|l:case s|c|l:return t+"102SE";case a|c|l|f|h:case a|l|f|h:case c|l|f|h:case l|f|h:return t+"102SW";case a|u|o|s|c:case a|u|o|s:case u|o|s:return t+"102NE";case a|u|o|f|h:case a|u|f|h:case a|u|o|h:case a|u|h:return t+"102NW";case a|u|o|s|c|f|h:case a|u|o|s|c|h:case a|u|o|s|f|h:case a|u|o|s|h:return t+"103N";case a|o|s|c|l|f|h:case o|s|c|l|f|h:case a|s|c|l|f|h:case s|c|l|f|h:return t+"103S";case a|u|o|s|c|l|f:case a|u|o|s|c|l:case u|o|s|c|l|f:case u|o|s|c|l:return t+"103E";case o|u|a|h|f|l|c:case a|u|c|l|f|h:case a|u|o|l|f|h:case a|u|l|f|h:return t+"103W";case a|o|c|f:return t+"Co100";case a:return t+"Co100NW";case o:return t+"Co100NE";case c:return t+"Co100SE";case f:return t+"Co100SW";case o|c:return t+"Co100NE-SE";case a|f:return t+"Co100NW-SW";case a|o:return t+"Co100NW-NE";case c|f:return t+"Co100SW-SE";case a|c:return t+"Co100NW-SE";case o|f:return t+"Co100NE-SW";case a|o:return t+"Co100NW-NE";case a|o|c:return t+"Co100NW-NE-SE";case a|o|f:return t+"Co100NW-NE-SW";case a|o|c|f|h:return t+"Co101W";case a|u|o|c|f:case a|u|c|f:return t+"Co101N";case a|o|c|l|f:case a|o|l|f|h:return t+"Co101S";case a|o|s|c|f:return t+"Co101E";case a|u|o|c:case u|o|c:case u|a|c:case u|c:return t+"Co101N-SE";case a|o|s|c:case a|s|c:case a|o|s:case s|a:return t+"Co101E-NW";case a|u|o|f:case a|u|f:case u|o|f:case u|f:return t+"Co101N-SW";case o|c|l|f:case o|c|l:case o|l|f:case l|o:return t+"Co101S-NE";case a|c|l|f:case a|l|f:case a|c|l:case a|l:return t+"Co101S-NW";case a|c|f|h:case c|f|h:case a|c|h:case h|c:return t+"Co101W-SE";case o|s|c|f:case o|s|f:case s|c|f:case s|f:return t+"Co101E-SW";case a|o|f|h:case a|o|h:case o|f|h:return t+"Co101W-NE";case a|u|o|c|f|h:case a|u|o|c|h:case a|u|c|f|h:case a|u|c|h:return t+"Co102NW";case a|u|o|s|c|f:case a|u|o|f|s:case u|o|s|c|f:case u|o|s|c:return t+"Co102NE";case a|o|c|l|f|h:case f|l|c|o|h:case a|o|s|c|l:return t+"Co102SW";case a|o|s|c|l|f:case f|l|c|a|s:return t+"Co102SE"}}function r(t,r,i,a){var u=!1;i.traverse(function(n){var i,o;n instanceof MeshObject&&(i=n.entityModel.get("name"),i===e(r,a.tile,a.bits)&&(u=!0,o=n.threeData.clone(),o.scale=new THREE.Vector3(.4,.4,.4),o.position=new THREE.Vector3(a.position.x,0,a.position.y),t.add(o)))}),u||window.console.error("Missing tile for bits: ",n(a.bits))}var i=0,a=1,u=2,o=4,s=8,c=16,l=32,f=64,h=128,p=a|u|o|s|c|l|f|h;return r}),e("dungeon_generator",["underscore","async","./map","./tile"],function(t,n,e,r){var i=["5171f82046fdf86b72000a65","5171f82846fdf86b72000a67","5171f80846fdf86b72000a60","5171f80146fdf86b72000a5c","5171f80246fdf86b72000a5d"],a=window.DungeonGenerator=function(t,n){if(!(t instanceof SceneAsset))throw Error("scene must be an instance of SceneAsset");this.scene=t,this.opts=n||{},this.opts.mapWidth=this.opts.mapWidth||20,this.opts.mapHeight=this.opts.mapHeight||20};return a.prototype.create=function(){var t=this,e=this.scene.veroldEngine.assetRegistry.entityCollection.model;n.forEach(i,function(n,r){var i=new e({id:n});i.fetch({success:function(){t.scene.veroldEngine.assetRegistry.entityCollection.add(i),r()}})},function(){t.generate(),t.createMapObject()})},a.prototype.generate=function(){this.map=new e({width:this.opts.mapWidth,height:this.opts.mapHeight})},a.prototype.createMapObject=function(){var t=this,n=this.mapObject=new THREE.Object3D,e=this.scene.veroldEngine.assetRegistry.getAsset(i[0]);e.load({success_hierarchy:function(){t.map.each(function(t){new r(n,"Claimed",e,t)}),t.scene.threeData.add(n)}})},a}),n("dungeon_generator")});